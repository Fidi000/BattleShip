<!DOCTYPE html>
<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="../icons/all.css">
    <meta charset="UTF-8">
    <title>LEADERBOARD</title>
</head>
	<link rel="stylesheet" type="text/css" href="../css_pages/leaderboard.css">

<script>
    window.onload = function () {
        totalPlayers("gameswon");
    }
    var playerarray;
    var legnth;
    var descending = 0;
    var first3 = 0;
    function createLeaderboard() {
        var x = 0;
        var leaderBoard = document.getElementById("leaderboard");
        for (var i = 0; i < length; i++) {
            var row = leaderBoard.insertRow(-1);
            var user = row.insertCell(-1);
            var won = row.insertCell(-1);
            var played = row.insertCell(-1);
            var time = row.insertCell(-1);
            user.innerHTML = playerarray[i]['username'];
            won.innerHTML = playerarray[i]['gameswon'];
            played.innerHTML = playerarray[i]['gamesplayed'];
            time.innerHTML = ms_changeformat(playerarray[i]['timeplayed']);
        }
        highlight();

    }
    function highlight() {
        var cells = document.getElementById('board').getElementsByTagName('td');
        if (cells.length > 11) {
            cells[0].innerHTML = "ðŸ¥‡" + cells[0].innerHTML;
            cells[4].innerHTML = "ðŸ¥ˆ" + cells[4].innerHTML;
            cells[8].innerHTML = "ðŸ¥‰" + cells[8].innerHTML;

            for (var i = 0; i < 4; i++) {
                cells[i].style.backgroundColor = "rgba(255,223,0, 0.7)"

            }
            for (var i = 4; i < 8; i++) {
                cells[i].style.backgroundColor = "rgba(192,192,192, 0.8)"

            }
            for (var i = 8; i < 12; i++) {
                cells[i].style.backgroundColor = "rgba(205, 127, 50, 0.8)"

            }
        }
    }
    function totalPlayers(orderbyproperty, asc) {
        document.getElementById("leaderboard").innerHTML = "";
        var order = orderbyproperty;
        //get size of database
        var j = new XMLHttpRequest();
        j.onreadystatechange = function () {
            if (j.readyState == 4 && j.status == 200) {
                playerarray = JSON.parse(j.responseText);
                length = playerarray.length;
                createLeaderboard();

            }
        };
        j.open('POST', '../php_pages/leaderboard.php');
        j.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        j.send("orderby=" + order + "&" + "test=" + asc);
    }

    function ms_changeformat(millis) {
        var minutes = Math.floor(millis / 60000);
        var seconds = ((millis % 60000) / 1000).toFixed(0);
        return (seconds == 60 ? (minutes + 1) + ":00" : minutes + ":" + (seconds < 10 ? "0" : "") + seconds);
    }

</script>
<header>

</header>

<body>
    <h1 style="text-align: center; color: white;">LEADERBOARD</h1>
    <div class="top_menu">
        <a class="navigatea" href="index.html">Home</a>
        <a class="navigatea" href="leaderboard.html">Leaderboard</a>
        <a class="navigatea" href="game.html">Play</a>
        <a class="navigatea" href="help.html">Help</a>
        <a class="navigatea" href="contact.html">Contact</a>
    </div>
    
    <table id="board">
        <thead>
            <tr>
                <th>Player <br> Name <br>
                    <button onclick="totalPlayers('username', 0);" class="sortbuttons"><i
                            class="fas fa-caret-up"></i></button>
                    <button onclick="totalPlayers('username', 1);" class="sortbuttons"><i
                            class="fas fa-caret-down"></i></button>
                </th>
                <th>Games<br> Won<br>
                    <button onclick="totalPlayers('gameswon', 0);" class="sortbuttons"><i
                            class="fas fa-caret-up"></i></button>
                    <button onclick="totalPlayers('gameswon', 1);" class="sortbuttons"><i
                            class="fas fa-caret-down"></i></button>
                </th>
                <th>Games<br> Played<br>
                    <button onclick="totalPlayers('gamesplayed', 0);" class="sortbuttons"><i
                            class="fas fa-caret-up"></i></button>
                    <button onclick="totalPlayers('gamesplayed', 1);" class="sortbuttons"><i
                            class="fas fa-caret-down"></i></button>
                </th>
                <th>Time Played<br>(m:s)<br>
                    <button onclick="totalPlayers('timeplayed', 0);" class="sortbuttons"><i
                            class="fas fa-caret-up"></i></button>
                    <button onclick="totalPlayers('timeplayed', 1);" class="sortbuttons"><i
                            class="fas fa-caret-down"></i></button>
                </th>
            </tr>
        </thead>


        <tbody id="leaderboard" class="playerrows">
        </tbody>
    </table>

</body>





</html>